module Game

open "UnityEngine.dll"
open UnityEngine

worldEntity World = {

  Goblins   : [Goblin]    
 
  Create() =  
    let avatar_generator = AvatarGenerator.Find()
    let goblinList =
      [for x in [0..avatar_generator.Amount- 1] do
       for characteristic in avatar_generator.SettingsList do
       select (Goblin.Create([("rwar", 8)]))]
    {
       Goblins = goblinList
    }    
}
 
entity Goblin = {
  inherit UnityGoblin
   
  settings : [(string * int)]
     
  //moving right           
  rule Position, IsMovingLegs =    
    wait Input.GetKey(KeyCode.Space) 
    yield Position + new Vector3(dt * 2.0f, 0.0f, 0.0f), true    

  //moving left
  rule Position, IsMovingLegs =
    wait Input.GetKey(KeyCode.C)
    yield Position - new Vector3(dt*2.0f, 0.0f, 0.0f), true
      
  Create(Settings : [(string * int)]) =  
    {
      settings = Settings  
      UnityGoblin = UnityGoblin.Instantiate()
    }
}  